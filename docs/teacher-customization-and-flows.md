## 교사용 커스터마이징 & 클래스/역할 핵심 사용자 흐름 설계

### 1. 주요 페르소나
- **교사(Teacher)**: 클래스 생성, 기능 구성, 수업 운영, 학생 관리.
- **보조 교사(Assistant)**: 교사의 위임을 받아 자료 업로드, 질문 관리 등 지원.
- **학생(Student)**: 허용된 기능 사용, 과제 제출, 활동 참여.

### 2. 교사용 사이드바 커스터마이징 흐름
1. 교사 대시보드에서 `기능 라이브러리` 버튼 선택 — 현재 UI에서는 배너/문서 링크로 설계안 안내.
2. 향후 구현: 모달/드로어에서 사용 가능한 도구 목록을 Drag & Drop 또는 토글로 선택.
   - 도구 카테고리: `소통`, `협업`, `평가`, `운영`, `분석`, `AI`.
3. 각 도구 설정 편집(이름, 권한, 기본 상태 등)은 TODO 상태. `ClassroomFeatureConfig` 타입으로 저장할 예정.
4. 사이드바 미리 보기에서 순서/그룹화 확인 → UI 구현 예정.
5. 저장 시 `classrooms/{classId}/metadata.featureConfig`에 기록 (현재 read-only 조회만 구현).
6. 저장된 구성을 `템플릿`으로 등록하여 다른 클래스에 재사용 — 향후 기능.

### 3. 수업 중 기능 전환 흐름
- 사이드바 항목 클릭 → 메인 캔버스에 해당 기능 로드.
- 도구별 `라이브 상태` 표시 (예: 채팅 활성, 퀴즈 진행 중).
- 교사는 실시간으로 기능을 활성/비활성 전환, 학생 뷰에 즉시 반영.
- 타이머, 랜덤 호출 등 운영 도구는 플로팅 패널에서 제어.

### 4. 클래스 생성 & 학생 초대 플로우
1. 교사: `클래스 생성` → 이름, 학년, 과목, 기간, 설명 입력.
2. 시스템: 클래스 코드 자동 생성 (`generateClassCode` → Firestore 저장).
3. 교사: 초대 링크 복사 또는 이메일로 공유.
4. 학생: 코드 입력 → Firebase Auth 로그인 → 참여 신청.
5. 교사: `승인 대기 목록`에서 학생 승인/거절.
6. 승인 시 역할 `student`와 기본 권한이 부여됨.

### 5. 권한 커스터마이징
- 기본 역할 권한은 RBAC 테이블로 관리.
- 교사는 학생별/그룹별 권한 오버라이드 설정 가능.
  - 예: 특정 학생에게 `채팅 작성 금지`, `Activity 댓글 제한`.
- UI: `학생 관리` 화면에서 체크박스/슬라이더로 조정 → `members/{memberId}.permissions` 저장.

### 6. 보조 교사 지정 흐름
1. 교사가 클래스 설정에서 `보조 교사 초대` 선택.
2. 이메일 입력 → 초대 이메일 전송 (Cloud Functions).
3. 초대 수락 시 `role: assistant`으로 `members`에 등록.
4. 교사는 보조 교사에게 허용할 기능(공지 작성, 자료 업로드 등)을 세부 설정.

### 7. 수업 세션 운영 흐름
1. 현재 React 앱에서는 에뮬레이터에서 가져온 세션 목록을 실시간(onSnapshot)으로 조회하고 선택할 수 있다.
2. 교사용 화면에 “새 세션 만들기” 폼이 추가되어 제목/차시/날짜/개요를 입력하면 `createSession` mutation을 호출해 세션을 생성할 수 있다. 생성 후 실시간 구독을 통해 목록이 즉시 갱신된다.
3. `status` 업데이트, 요약 리포트 생성, 세션 종료 플로우는 미구현 상태이며, Firestore 문서 업데이트 및 Functions 연동이 필요하다.
4. 실시간 데이터 기록·알림은 문서상 설계만 존재하며, 차후 `sessions/{sessionId}` 서브컬렉션과 Functions로 확장 예정이다.

### 8. 학생 경험
- `StudentOverview` 페이지에서 클래스/세션 선택, 활동/질문/채팅 목록을 Firestore 에뮬레이터에서 조회.
- 공지 배너로 Firestore 연동 전임을 안내하고, 데이터가 없을 경우 시드 실행 가이드가 노출된다.
- 실제 클래스 참여 플로우(코드 입력, Auth, 권한 제한)는 미구현 상태로, 향후 RBAC/뮤테이션 도입과 함께 구현 필요.

### 9. 알림 & 협업
- 현재 구현: 토스트(`sonner`)를 통한 간단한 피드백, 링크 복사 등. 푸시/알림 시스템은 미구현.
- 문서 설계: 교사 액션/학생 질문에 대한 알림 흐름, AI 피드백 공유 등을 향후 구현 대상으로 유지.

### 10. UX 고려 사항
- 사이드바 커스터마이징은 온보딩 튜토리얼 제공.
- 라이브 세션 중 설정 변경 시 학생에게 안내 토스트 표시.
- 접근성: 키보드 드래그 지원, 역할별 시각적 구분, 다국어 레이블.
- 모바일 대응: 풀스크린 기능 전환, 제스처 기반 네비게이션.

이 플로우를 기준으로 UI/스토어/서비스 레이어를 설계하면, 교사가 원하는 기능 조합으로 수업을 운영하고 학생에게 역할 기반 경험을 제공할 수 있습니다.

