<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>수업 상세 - AI ClassBoard</title>
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600;700&family=Lato:wght@300;400;700&family=Noto+Sans+KR:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <link href="https://unpkg.com/boxicons@2.1.4/css/boxicons.min.css" rel="stylesheet">
    <link rel="stylesheet" href="main-session.css">
    <link rel="stylesheet" href="session.css">
</head>
<body>
    <div class="session-detail-container">
        <div class="session-detail-header">
            <button class="btn-back" onclick="window.location.href='main-session.html'">
                <i class="bx bx-arrow-back"></i> 돌아가기
            </button>
            <div style="flex: 1;">
                <h1 id="session-title">수업 상세</h1>
                <div class="session-meta-header">
                    <span id="session-class-name">-</span>
                    <span class="session-date" id="session-date">-</span>
                    <span class="session-number" id="session-number">-</span>
                </div>
            </div>
        </div>

        <!-- 탭 네비게이션 -->
        <div class="session-tabs">
            <button class="session-tab active" data-tab="activity">
                <i class="bx bxs-grid-alt"></i>
                <span>활동</span>
            </button>
            <button class="session-tab" data-tab="ask">
                <i class="bx bxs-chat"></i>
                <span>채팅</span>
            </button>
            <button class="session-tab" data-tab="quiz">
                <i class="bx bxs-brain"></i>
                <span>퀴즈</span>
            </button>
            <button class="session-tab" data-tab="materials">
                <i class="bx bxs-folder"></i>
                <span>자료실</span>
            </button>
        </div>

        <!-- 탭 컨텐츠 -->
        <div class="session-tab-content" id="session-tab-content">
            <!-- Activity 탭 -->
            <div class="tab-pane active" id="tab-activity">
                <div class="content-header">
                    <h1>활동</h1>
                    <p>자유롭게 아이디어를 나누고 함께 성장해요</p>
                    <button class="btn-create-post" id="create-post-btn">
                        <i class="bx bx-plus"></i> 새 게시글 작성
                    </button>
                </div>

                <!-- 게시글 작성 모달 -->
                <div class="modal" id="post-modal">
                    <div class="modal-content">
                        <div class="modal-header">
                            <h3>새 게시글 작성</h3>
                            <button class="modal-close" id="close-modal">
                                <i class="bx bx-x"></i>
                            </button>
                        </div>
                        <div class="modal-body">
                            <textarea id="post-text" placeholder="무엇을 공유하고 싶으신가요?" rows="5"></textarea>
                            <div class="image-upload">
                                <input type="file" id="image-upload" accept="image/*" multiple style="display: none;">
                                <label for="image-upload" class="upload-label">
                                    <i class="bx bx-image"></i> 이미지 추가
                                </label>
                                <div class="image-preview" id="image-preview"></div>
                            </div>
                            <div class="modal-footer">
                                <button class="btn-cancel" id="cancel-post">취소</button>
                                <button class="btn-submit" id="submit-post">게시하기</button>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- 게시글 보드 (Padlet 스타일) -->
                <div class="activity-board" id="activity-board">
                    <!-- 게시글은 JavaScript로 동적 생성 -->
                </div>
            </div>

            <!-- Ask 탭 -->
            <div class="tab-pane" id="tab-ask">
                <!-- Ask Triple Layout: Slido Q&A + WordCloud + 채팅 -->
                <div class="ask-layout">
                    <!-- Slido Q&A 섹션 (왼쪽) -->
                    <div class="slido-section">
                        <div class="slido-header">
                            <h3><i class="bx bx-question-mark"></i> 질문 & 답변</h3>
                        </div>
                        <div class="question-list" id="questionList">
                            <!-- 질문 목록이 여기에 동적으로 생성됩니다 -->
                        </div>
                        <form id="questionForm" class="question-form">
                            <input 
                                type="text" 
                                id="questionInput" 
                                placeholder="질문을 입력하세요..." 
                                class="question-input"
                            />
                            <button type="submit" class="question-submit-btn">
                                <i class="bx bx-send"></i> 등록
                            </button>
                        </form>
                    </div>

                    <!-- WordCloud 섹션 (중앙) -->
                    <div class="wordcloud-section">
                        <div class="wordcloud-header">
                            <h3><i class="bx bx-cloud"></i> 실시간 WordCloud</h3>
                        </div>
                        <div class="wordcloud-container">
                            <canvas id="wordCloudCanvas"></canvas>
                        </div>
                    </div>

                    <!-- 채팅 섹션 (오른쪽) -->
                    <div class="chat-section">
                        <div class="chat-header">
                            <h3><i class="bx bxs-chat"></i> 실시간 채팅</h3>
                            <div class="chat-status">
                                <span class="status-dot"></span>
                                <span id="online-count">참여자 0명</span>
                            </div>
                        </div>
                        <div id="chatMessages" class="chat-window">
                            <!-- 채팅 메시지는 JavaScript로 동적 생성 -->
                        </div>
                        <div class="chat-input">
                            <button class="chat-input-btn">
                                <i class="bx bx-smile"></i>
                            </button>
                            <label class="chat-input-btn">
                                <input type="file" id="chat-file-input" hidden>
                                <i class="bx bx-paperclip"></i>
                            </label>
                            <input 
                                type="text" 
                                id="chatInput" 
                                placeholder="메시지를 입력하세요..." 
                                class="chat-input-field"
                            />
                            <button id="sendChat" class="chat-send-btn">
                                <i class="bx bx-send"></i> 전송
                            </button>
                        </div>
                    </div>
                </div>

                <!-- AI 요약 모달 -->
                <div class="modal" id="summary-modal">
                    <div class="modal-content">
                        <div class="modal-header">
                            <h3>질문 요약 (AI)</h3>
                            <button class="modal-close" id="close-summary-modal">
                                <i class="bx bx-x"></i>
                            </button>
                        </div>
                        <div class="modal-body">
                            <div class="summary-loading" id="summary-loading">
                                <div class="loading-spinner">
                                    <i class="bx bx-loader-alt bx-spin"></i>
                                </div>
                                <p>AI가 질문을 분석하고 요약 중입니다...</p>
                            </div>
                            <div class="summary-result" id="summary-result" style="display: none;">
                                <!-- 요약 결과는 JavaScript로 동적 생성 -->
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Quiz 탭 -->
            <div class="tab-pane" id="tab-quiz">
                <div class="content-header">
                    <h1>퀴즈</h1>
                    <p>AI 기반 자동 채점 시스템으로 학습을 확인하세요</p>
                </div>

                <!-- 진행 중인 퀴즈 -->
                <div class="quiz-list" id="quiz-list">
                    <!-- 퀴즈 목록은 JavaScript로 동적 생성 -->
                </div>

                <!-- 퀴즈 풀이 영역 -->
                <div class="quiz-container" id="quiz-container" style="display: none;">
                    <div class="quiz-header">
                        <h2 id="quiz-title">퀴즈 제목</h2>
                        <div class="quiz-progress">
                            <span id="current-question">0</span> / <span id="total-questions">0</span>
                        </div>
                    </div>

                    <div class="quiz-questions" id="quiz-questions">
                        <!-- 문제는 JavaScript로 동적 생성 -->
                    </div>

                    <div class="quiz-footer">
                        <button class="btn-prev" id="prev-btn" disabled>이전</button>
                        <button class="btn-submit-quiz" id="submit-quiz-btn">제출하기</button>
                    </div>
                </div>

                <!-- 결과 페이지 -->
                <div class="quiz-result" id="quiz-result" style="display: none;">
                    <div class="result-header">
                        <h2>퀴즈 결과</h2>
                        <div class="score-display">
                            <span class="score-value" id="final-score">0</span>
                            <span class="score-total">/ 100</span>
                        </div>
                    </div>

                    <div class="result-summary">
                        <div class="summary-card correct">
                            <i class="bx bx-check-circle"></i>
                            <div>
                                <span class="summary-value" id="correct-count">0</span>
                                <span class="summary-label">정답</span>
                            </div>
                        </div>
                        <div class="summary-card incorrect">
                            <i class="bx bx-x-circle"></i>
                            <div>
                                <span class="summary-value" id="incorrect-count">0</span>
                                <span class="summary-label">오답</span>
                            </div>
                        </div>
                        <div class="summary-card total">
                            <i class="bx bx-list-ol"></i>
                            <div>
                                <span class="summary-value" id="total-count">0</span>
                                <span class="summary-label">총 문제</span>
                            </div>
                        </div>
                    </div>

                    <div class="ai-feedback" id="ai-feedback">
                        <div class="feedback-content" id="feedback-content">
                            <div class="loading-spinner">
                                <i class="bx bx-loader-alt bx-spin"></i>
                            </div>
                            <p>AI 피드백을 생성하고 있습니다...</p>
                        </div>
                    </div>

                    <div class="result-questions" id="result-questions">
                        <!-- 결과 상세는 JavaScript로 동적 생성 -->
                    </div>

                    <div class="result-actions">
                        <button class="btn-retry" onclick="location.reload()">
                            <i class="bx bx-refresh"></i> 다시 풀기
                        </button>
                        <button class="btn-home" onclick="goToQuizList()">
                            <i class="bx bx-home"></i> 퀴즈 목록
                        </button>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- 토스트 메시지 -->
    <div id="toast-container" class="toast-container"></div>

    <script src="https://cdnjs.cloudflare.com/ajax/libs/wordcloud2.js/1.1.1/wordcloud2.min.js"></script>
    <script src="dialog.js"></script>
    <script src="class-storage-utils.js"></script>
    <script src="session-detail.js"></script>
    <script src="ask-session.js"></script>
    <script src="activity.js"></script>
    <script src="quiz.js"></script>
</body>
</html>

